 <div class="container">
    <div class="menu">
        <app-menu-component></app-menu-component>
    </div>

    <div class="main" >
        <div class="header">
           <h1>Users Management</h1> 
        </div>
        <ag-grid-angular
      class="ag-theme-quartz ag-grid"
      [theme]="theme"
      [rowData]="users"
      [columnDefs]="colDef"
      [defaultColDef]="colDefault"
      [pagination]="true"
      [paginationPageSize]="pageSize"
      [paginationPageSizeSelector]="pageSizeSelector"
      domLayout="autoHeight"
    >
    </ag-grid-angular>
    </div>
</div>





<p-dialog position='top' header="Update User Info" [modal]="true" [(visible)]="editeDialog" [style]="{ width: '25rem' }">
      <div style="margin-top: 5px;">
        <label for="addedtitle" >User Name</label>
        <input style="width:67%;margin-left:23px" class="dialog-input" pInputText id="addedtitle" [(ngModel)]="updatedUser!.name" required class="flex-auto" autocomplete="off"/>
    </div>
    <div style="margin-top: 5px;">
        <label for="addedDecs" >User Email</label>
        <input style="width:67%;margin-left:23px" class="dialog-input" pInputText id="addedDesc" [(ngModel)]="updatedUser!.email" required class="flex-auto" autocomplete="off"/>
    </div>
    <div style="margin-top: 5px;">
      <label for="select">User Role</label>
        <p-select
            style="margin-left: 25px;"
            id="select"
            [options]="['USER','ADMIN']"
            [(ngModel)]="updatedUser!.role"
            [checkmark]="true"
            [showClear]="true"
            appendTo="body"
            dropdownIcon="pi pi-chevron-up"
            class="dialog-select"
            placeholder="SELECT STATUS">
        </p-select>
    </div>
    <div class="dialog-button">
        <p-button class="cancel"  label="Cancel" severity="secondary" (click)="editeDialog=false" />
        <p-button class="confirm" label="Confirm" (click)="updateUser()" severity="info" />
    </div>
</p-dialog>






<p-dialog position='top' header="Delete User" [modal]="true" [(visible)]="deleteDialog" [style]="{ width: '25rem' }">
  <div style="display: flex;flex-direction:row">
    <i style="margin-top: 15px;font-size:25px;" class="pi pi-exclamation-circle"></i>
    <p style="font-size:17px;margin-left:20px"> Do you want to delete this User?</p>
  </div>
    <div class="dialog-button">
        <p-button class="cancel"  label="Cancel" severity="secondary" (click)="deleteDialog=false" />
        <p-button class="confirm" label="Delete" (click)="deleteUser()" severity="danger"/>
    </div>
</p-dialog>

















<!-- </div>
    <div class="main-container">
    @if (displayUsers) {
    @for (user of users; track user.id) {
    <div class="card-container">
        <div class="head-container">
            <img [src]="this.getImageUrl(user.imageName!)" >
            <div>
               <p>Id: {{user.id}}</p>
               <p>Name: {{user.name}}</p>
               <p>Role: {{user.role}}</p>
            </div>
        </div>
        <p id="email">email: {{user.email}}</p>

        <div *ngIf="buttonDisplay" class="modify-button">
        <button id="edite-menu" [mat-menu-trigger-for]="editeMenu" id="edite-button"><mat-icon>edite</mat-icon></button>
        <mat-menu class="edite-menu" #editeMenu="matMenu" [hasBackdrop]="false">
            
            <input class="login-input" [(ngModel)]="user.name" placeholder="Enter Username" (click)="$event.stopPropagation()" required />
            <input class="login-input" [(ngModel)]="user.role" placeholder="Enter User's Role" (click)="$event.stopPropagation()" required />
            <input id="email-input" class="login-input" [(ngModel)]="user.email" type="text" placeholder="Enter Email" (click)="$event.stopPropagation()" required />
            <div id="image-container">
            <input id="image-input" type="file" (change)="onImageSelected($event,user)" style="display: none;" (click)="$event.stopPropagation()" accept="image/*" />    
            @if (user.imageName&&user.imageName!='') {
                <label for="image-input" id="image-label" (click)="$event.stopPropagation()">Change image</label>      
                <p id="image-text" (click)="$event.stopPropagation()">{{user.imageName}}</p>
            } @else {
                <label for="image-input" id="image-label" (click)="$event.stopPropagation()">Choose image</label>
                <p id="image-text" (click)="$event.stopPropagation()">no image chosen</p>
            }
    </div>
            <button id="edite-mat-button" class="header-button">cancel</button>
            <button id="edite-mat-button" class="header-button" (click)="updateUser(user)">confirm</button>
        </mat-menu>


        <button [mat-menu-trigger-for]="deleteMenu" id="delete-button"><mat-icon>delete</mat-icon></button>
        <mat-menu class="delete-menu" #deleteMenu="matMenu" [hasBackdrop]="false">
            <h4 >Delete User?</h4>
            <button id="delete-mat-button" class="header-button">cancel</button>
            <button id="delete-mat-button" class="header-button" (click)="deleteUser(searchedUser.id!)">confirm</button>
        </mat-menu>
        </div>
    </div>
    }}



    @else {
        <div class="card-container">
        <div class="head-container">
            <img [src]="this.getImageUrl(searchedUser.imageName!)" >
            <div>
               <p>Id: {{searchedUser.id}}</p>
               <p>Name: {{searchedUser.name}}</p>
               <p>Role: {{searchedUser.role}}</p>
            </div>
        </div>
        <p id="email">email: {{searchedUser.email}}</p>

        <div *ngIf="buttonDisplay" class="modify-button">
        <button id="edite-menu" [mat-menu-trigger-for]="editeMenu" id="edite-button"><mat-icon>edite</mat-icon></button>
        <mat-menu class="edite-menu" #editeMenu="matMenu" [hasBackdrop]="false">
            
            <input class="login-input" [(ngModel)]="searchedUser.name" placeholder="Enter Username" (click)="$event.stopPropagation()" required />
            <input class="login-input" [(ngModel)]="searchedUser.role" placeholder="Enter User's Role" (click)="$event.stopPropagation()" required />
            <input id="email-input" class="login-input" [(ngModel)]="searchedUser.email" type="text" placeholder="Enter Email" (click)="$event.stopPropagation()" required />
            <div id="image-container">
            <input id="image-input" type="file" (change)="onImageSelected($event,searchedUser)" style="display: none;" (click)="$event.stopPropagation()" accept="image/*" />    
            @if (searchedUser.imageName&&searchedUser.imageName!='') {
                <label for="image-input" id="image-label" (click)="$event.stopPropagation()">Change image</label>      
                <p id="image-text" (click)="$event.stopPropagation()">{{searchedUser.imageName}}</p>
            } @else {
                <label for="image-input" id="image-label" (click)="$event.stopPropagation()">Choose image</label>
                <p id="image-text" (click)="$event.stopPropagation()">no image chosen</p>
            }
    </div>
            <button id="edite-mat-button" class="header-button">cancel</button>
            <button id="edite-mat-button" class="header-button" (click)="updateUser(searchedUser)">confirm</button>
        </mat-menu>


        <button [mat-menu-trigger-for]="deleteMenu" id="delete-button"><mat-icon>delete</mat-icon></button>
        <mat-menu class="delete-menu" #deleteMenu="matMenu" [hasBackdrop]="false">
            <h4 >Delete User?</h4>
            <button id="delete-mat-button" class="header-button">cancel</button>
            <button id="delete-mat-button" class="header-button" (click)="deleteUser(searchedUser.id!)">confirm</button>
        </mat-menu>
        </div>
    </div>
      
    }



    <div id="select-button">
    <mat-select
  class="header-button"
  [(ngModel)]="searchedId"
  placeholder="Select Id"
  (selectionChange)="idChange($event.value)">
    @for (i of numbers; track $index) {
      <mat-option [value]="i">{{ i }}</mat-option>
    }
  </mat-select>
  <button *ngIf="displayUser==true" class="header-button" (click)="getUsers()">cancel</button>
  </div>
    </div>
    @if (buttonDisplay==false) {
        <button id="modify" (click)="buttonDisplay=true">modify</button>
    }@else {
        <button id="modify" (click)="buttonDisplay=false">undo</button>
    }
    
</div> -->